<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>英雄裝備分析</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .header h1 {
            margin: 0;
            color: #333;
        }
        .hero-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }
        .hero-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.2s;
            cursor: pointer;
            text-decoration: none;
            color: inherit;
        }
        .hero-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .hero-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        .hero-image {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #4A90E2;
        }
        .hero-name {
            font-size: 18px;
            font-weight: bold;
            margin: 0;
            color: #333;
        }
        .hero-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            font-size: 14px;
            color: #666;
        }
        .stat-label {
            color: #999;
        }
        .positive-delta {
            color: #28a745;
        }
        .negative-delta {
            color: #dc3545;
        }
        .sort-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .sort-button {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            background: #4A90E2;
            color: white;
            cursor: pointer;
            transition: background 0.2s;
        }
        .sort-button:hover {
            background: #357ABD;
        }
        .sort-button.active {
            background: #2C5282;
        }
        .search-box {
            padding: 8px 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-right: auto;
            width: 200px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>英雄裝備分析</h1>
    </div>

    <div class="sort-controls">
        <input type="text" class="search-box" placeholder="搜索英雄..." oninput="filterHeroes(this.value)">
        <button class="sort-button active" data-sort="name">按名稱</button>
        <button class="sort-button" data-sort="avgPlacement">按平均名次</button>
        <button class="sort-button" data-sort="delta">按Delta值</button>
        <button class="sort-button" data-sort="winRate">按勝率</button>
        <button class="sort-button" data-sort="top4Rate">按前四率</button>
        <button class="sort-button" data-sort="totalGames">按使用次數</button>
    </div>

    <div class="hero-grid" id="heroGrid">
        <!-- 英雄卡片將通過JavaScript填充 -->
    </div>

    <script>
        let heroes = [];
        let currentSort = {
            key: 'name',
            ascending: true
        };

        function createHeroCard(hero) {
            const card = document.createElement('div');
            card.className = 'hero-card';
            card.onclick = () => window.location.href = `hero_items.html?hero=${hero.id}`;
            
            const heroName = hero.id.replace('TFT13_', '');
            card.innerHTML = `
                <img src="tft13_character_images/tft13_${heroName.toLowerCase()}_square.tft_set13.jpg" 
                     alt="${heroName}" 
                     class="hero-image"
                     onerror="this.src='data:image/svg+xml,<svg xmlns=\'http://www.w3.org/2000/svg\' width=\'100\' height=\'100\'><rect width=\'100\' height=\'100\' fill=\'%234A90E2\'/><text x=\'50\' y=\'50\' font-size=\'20\' fill=\'white\' text-anchor=\'middle\' dominant-baseline=\'middle\'>${heroName.slice(0, 2).toUpperCase()}</text></svg>'">
                <div class="hero-info">
                    <h3>${heroName}</h3>
                    <p>平均名次: ${hero.avgPlacement.toFixed(2)}</p>
                    <p>Delta: ${hero.delta.toFixed(2)}</p>
                    <p>使用次數: ${hero.totalGames}</p>
                    <p>勝率: ${hero.winRate}%</p>
                    <p>前四率: ${hero.top4Rate}%</p>
                </div>
            `;
            return card;
        }

        function sortHeroes(key) {
            const buttons = document.querySelectorAll('.sort-button');
            buttons.forEach(button => {
                button.classList.remove('active');
                if (button.dataset.sort === key) {
                    button.classList.add('active');
                }
            });

            if (currentSort.key === key) {
                currentSort.ascending = !currentSort.ascending;
            } else {
                currentSort.key = key;
                currentSort.ascending = true;
            }

            heroes.sort((a, b) => {
                if (key === 'name') {
                    return currentSort.ascending ? 
                        a[key].localeCompare(b[key]) : 
                        b[key].localeCompare(a[key]);
                }
                return currentSort.ascending ? 
                    a[key] - b[key] : 
                    b[key] - a[key];
            });

            renderHeroes();
        }

        function filterHeroes(query) {
            const filteredHeroes = heroes.filter(hero => 
                hero.name.toLowerCase().includes(query.toLowerCase())
            );
            renderHeroGrid(filteredHeroes);
        }

        function renderHeroGrid(heroList) {
            const grid = document.getElementById('heroGrid');
            grid.innerHTML = heroList.map(createHeroCard).join('');
        }

        function renderHeroes() {
            renderHeroGrid(heroes);
        }

        async function loadHeroes() {
            try {
                const response = await fetch('hero_data/hero_list.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                heroes = await response.json();
                console.log('英雄數據加載成功:', heroes);
                
                // 渲染英雄卡片
                const heroGrid = document.getElementById('heroGrid');
                heroGrid.innerHTML = '';
                heroes.forEach(hero => {
                    const card = document.createElement('div');
                    card.className = 'hero-card';
                    card.onclick = () => window.location.href = `hero_items.html?hero=TFT13_${hero.name}`;
                    
                    card.innerHTML = `
                        <div class="hero-header">
                            <img src="tft13_character_images/tft13_${hero.name.toLowerCase()}_square.tft_set13.jpg" 
                                 alt="${hero.name}" 
                                 class="hero-image"
                                 onerror="this.src='data:image/svg+xml,<svg xmlns=\'http://www.w3.org/2000/svg\' width=\'100\' height=\'100\'><rect width=\'100\' height=\'100\' fill=\'%234A90E2\'/><text x=\'50\' y=\'50\' font-size=\'20\' fill=\'white\' text-anchor=\'middle\' dominant-baseline=\'middle\'>${hero.name.slice(0, 2).toUpperCase()}</text></svg>'">
                            <h3 class="hero-name">${hero.name}</h3>
                        </div>
                        <div class="hero-stats">
                            <div>
                                <span class="stat-label">平均名次:</span>
                                <span>${hero.avgPlacement.toFixed(2)}</span>
                            </div>
                            <div>
                                <span class="stat-label">Delta:</span>
                                <span class="${hero.delta < 0 ? 'positive-delta' : 'negative-delta'}">${hero.delta.toFixed(2)}</span>
                            </div>
                            <div>
                                <span class="stat-label">使用次數:</span>
                                <span>${hero.totalGames}</span>
                            </div>
                            <div>
                                <span class="stat-label">勝率:</span>
                                <span>${hero.winRate}%</span>
                            </div>
                            <div>
                                <span class="stat-label">前四率:</span>
                                <span>${hero.top4Rate}%</span>
                            </div>
                        </div>
                    `;
                    heroGrid.appendChild(card);
                });

                // 添加排序按鈕事件監聽器
                document.querySelectorAll('.sort-button').forEach(button => {
                    button.addEventListener('click', () => {
                        const key = button.dataset.sort;
                        sortHeroes(key);
                    });
                });

            } catch (error) {
                console.error('Error:', error);
                document.getElementById('heroGrid').innerHTML = '<p>無法載入英雄數據</p>';
            }
        }

        loadHeroes();
    </script>
</body>
</html> 